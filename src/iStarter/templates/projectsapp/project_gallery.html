{% extends "base.html" %}

{% block classification_head %} {{ classification|upper }} {% endblock classification_head %}		

{% block extra_js %}
  	<script>
  		// Adds tags to an array for form population
  		var inputTags = new Array();
  		
  		function modifyTagsArray(e) {
  			
  			idx = inputTags.indexOf(e.id);
  			//alert(idx);
  			if (idx < 0) {
  				addToTagsArray(e.id);
  				document.getElementById(e.id).className = "btn btn-mini btn-primary";
  				}
  			else {
  				removeFromArray(e.id);
  				document.getElementById(e.id).className = "btn btn-mini";
  				}
  			//alert(inputTags);
  		}
  		
  		// Add an element to the array
  		function addToTagsArray(value) {
  			inputTags.push(value);
  		}
  	  	
  		// remove an element from the array
  		function removeFromArray(value) {
  			idx = inputTags.indexOf(value);
  			inputTags.splice( idx, 5 );
  		}
  		
  		// Assign the hidden tags field to the tags array
  		function setTagsList() {
  			var tagArr = inputTags.join(",");
  			var a_href = $('#tag_filter').attr('href');
  			a_href += tagArr;
  			var new_href = $('#tag_filter').attr('href', a_href);
    		}
  		

	  	// Set the sortlist
  		function toggleSortOrder(el) {
	  		alert(el.id);
	  		var direction = $("#" + el.id).attr('direction');
	  		alert(direction);
	  		
	  		if (direction==-1) {
	  			alert('hello');
	  			$("#" + el.id).attr('direction', 1);
	  			alert($("#" + el.id).attr('direction'));
	  			var href_in = $("#" + el.id).attr('href');
		  		href_out = href_in.replace('-'+el.id, el.id);
		  		var new_href = $("#"+el.id).attr('href', href_out);
	  		}
	  		
	  		else  {
	  			alert('else');
	  			var new_direction = $("#" + el.id).attr('direction', -1);
	  			alert($("#" + el.id).attr('direction'));
	  			var href_in = $("#" + el.id).attr('href');
		  		href_out = href_in.replace(el.id, '-'+el.id);
		  		var new_href = $("#"+el.id).attr('href', href_out);
	  		}

	  	}

	  	// Set the sortlist
  		function setSortList() {}

  		
	  	// Set the sortlist
  		function setSortList() {}
	  			
  		
	  		
  	</script>
{% endblock extra_js %} 

{% block main_block %}

<div class="container-fluid">
      <div class="row-fluid">
        <div class="span3">
          <div class="well sidebar-nav">
            <ul class="nav nav-list">
            	
              	<li class="nav-header">Tag Filters</li>
			  	<li style="padding:2px; border-radius:3px; margin:0px auto 5px auto; overflow: auto; max-height: 200px;">
					{% for known_tag in known_tags %}
						<button id="{{ known_tag }}" style="margin:0px auto 4px auto;" class="btn btn-mini" onclick="modifyTagsArray(this)" type="button">{{ known_tag }}</button>
					{% endfor %}
				<li>
					<button style="float:right; margin:5px; auto" class="btn btn-primary" onclick="setTagsList()" id="{{ sorts_and_filters.tag_item.id }}" href="/projects/gallery_filtered/{{sorts_and_filters.tag_item.url}}">
						{{ sorts_and_filters.tag_item.display_name }}
					</button>
				</li>
                
				<hr></hr>
                
                <li class="nav-header">Sort By</li>
            	<li class="active"><a href="/projects/gallery_filtered/">No Sort</a></li>
            	<!-- The actual sorts -->
            	{% for sort_item in sorts_and_filters.sort_items %}
           		<li>
           			<a onclick="toggleSortOrder(this)" direction= "{{ sort_item.direction }}" id="{{ sort_item.id }}" href="/projects/gallery_filtered/{{ sort_item.url }}"> {{ sort_item.display_name }} </a>
           		</li>
            	{% endfor %}
              	
            </ul>
          </div><!--/.well -->
        </div><!--/span-->
        
        
        <div class="span9">
        	<div class="hero-unit">
            	<h1>{{ page_title }}</h1>
            	<p>Its your turn to drive.</p>
            	<p><a href="#" class="btn btn-primary btn-large">Learn more &raquo;</a></p>
          	</div>
		  
			{% for row in tableData %}
				{% if forloop.counter0|divisibleby:"3" %}
					<div class="row-fluid">
				{% endif %}
				{% for cell in row %}
					<li class="span4">
						<div class="thumbnail" style="height:450px;">
							{% if cell.backPercentage < 33 %} 
								{% if cell.active %}
									<div class="progress progress-info progress-striped active">
										<div class="bar" style="width: {{cell.backPercentage}}%;"></div>
									</div>
								{% else %}
									<div class="progress progress-danger">
										<div class="bar" style="width: {{cell.backPercentage}}%;"></div>
									</div>
								{% endif %}
							{% elif cell.backPercentage < 66 %}
								{% if cell.active %}
									<div class="progress progress-info progress-striped active">
										<div class="bar" style="width: {{cell.backPercentage}}%;"></div>
									</div>
								{% else %}
									<div class="progress progress-warning">
										<div class="bar" style="width: {{cell.backPercentage}}%;"></div>
									</div>
								{% endif %}
							{% else %}
								{% if cell.active %}
									<div class="progress progress-info progress-striped active">
										<div class="bar" style="width: {{cell.backPercentage}}%;"></div>
									</div>
								{% else %}
									<div class="progress progress-success">
										<div class="bar" style="width: {{cell.backPercentage}}%;"></div>
									</div>
								{% endif %}
							{% endif %}
							<center><a href="/projects/project_detail/{{ cell.id }}"><img src="/static/images/300x200.png"></a></center>
							<div class="caption">					
								<h4>{{ cell.title }}</h4>
								<p> {{ cell.description }} </p>
								<i class="icon-thumbs-up"></i> {{cell.num_likes}} <i class="icon-thumbs-down"></i> {{cell.num_dislikes}}
							</div>
						</div>
					</li>
				{% endfor %}
				{% if forloop.counter|divisibleby:"3" %}	
					</div><!--/row-->
				{% endif %}
			{% endfor %}


    </div><!--/.fluid-container-->
    <hr>

 <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="../assets/js/jquery.js"></script>
    <script src="../assets/js/bootstrap-transition.js"></script>
    <script src="../assets/js/bootstrap-alert.js"></script>
    <script src="../assets/js/bootstrap-modal.js"></script>
    <script src="../assets/js/bootstrap-dropdown.js"></script>
    <script src="../assets/js/bootstrap-scrollspy.js"></script>
    <script src="../assets/js/bootstrap-tab.js"></script>
    <script src="../assets/js/bootstrap-tooltip.js"></script>
    <script src="../assets/js/bootstrap-popover.js"></script>
    <script src="../assets/js/bootstrap-button.js"></script>
    <script src="../assets/js/bootstrap-collapse.js"></script>
    <script src="../assets/js/bootstrap-carousel.js"></script>
    <script src="../assets/js/bootstrap-typeahead.js"></script>

{% endblock main_block %}

{% block classification_tail %} {{ classification }} {% endblock classification_tail %}
